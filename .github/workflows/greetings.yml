name: Greet Issues and Pull Requests

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]

jobs:
  greet:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Handle Greetings for Issues and PRs
        uses: actions/github-script@v6
        with:
          script: |
            const isIssue = !!context.payload.issue;
            const isPullRequest = !!context.payload.pull_request;
            let number, title, user;

            if (isIssue) {
              const issue = context.payload.issue;
              user = issue.user.login;
              number = issue.number;
              title = issue.title;
              const message = `ğŸ‘‹ Hello @${user}! Thank you for opening this issue titled "**${title}**"! We're excited to see your contribution and a maintainer will get back to you shortly ğŸ˜Š! \n\nPlease ensure the following:\n1. Be respectful. \n2. Follow the contribution guidelines.\n\nHappy coding! ğŸš€`;

              await github.rest.issues.createComment({
                ...context.repo,
                issue_number: number,
                body: message
              });

              const issueBody = issue.body || '';
              if (issueBody.trim().length === 0) {
                const requestInfoMessage = `ğŸ§ We would appreciate it if you could provide us with more info about this issue, @${user}! ğŸ¤”`;
                await github.rest.issues.createComment({
                  ...context.repo,
                  issue_number: number,
                  body: requestInfoMessage
                });
              }
            }

            if (isPullRequest) {
              const pullRequest = context.payload.pull_request;
              user = pullRequest.user.login;
              number = pullRequest.number;
              title = pullRequest.title;
              const message = `ğŸ‘‹ Hello @${user}! Thank you for opening this pull request titled "**${title}**"! A maintainer will review your changes soon. Stay tuned! ğŸ˜Š`;

              await github.rest.issues.createComment({
                ...context.repo,
                issue_number: number,
                body: message
              });

              const prBody = pullRequest.body || '';
              if (prBody.trim().length === 0) {
                const requestInfoMessage = `ğŸ§ We would appreciate it if you could provide more details about this pull request, @${user}! ğŸ¤”`;
                await github.rest.issues.createComment({
                  ...context.repo,
                  issue_number: number,
                  body: requestInfoMessage
                });
              }
            }

